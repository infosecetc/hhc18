



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content="Dan Roberts">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>LineCon - 2018 SANS Holiday Hack Challenge Solution</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.572ca0f0.css">
      
        <link rel="stylesheet" href="assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="green">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#linecon" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="2018 SANS Holiday Hack Challenge Solution" class="md-header-nav__button md-logo">
          
            <i class="md-icon">ac_unit</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                2018 SANS Holiday Hack Challenge Solution
              </span>
              <span class="md-header-nav__topic">
                LineCon
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="2018 SANS Holiday Hack Challenge Solution" class="md-nav__button md-logo">
      
        <i class="md-icon">ac_unit</i>
      
    </a>
    2018 SANS Holiday Hack Challenge Solution
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        LineCon
      </label>
    
    <a href="linecon.html" title="LineCon" class="md-nav__link md-nav__link--active">
      LineCon
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#curiosity" title="Curiosity" class="md-nav__link">
    Curiosity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#websockets" title="WebSockets" class="md-nav__link">
    WebSockets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dna" title="DNA" class="md-nav__link">
    DNA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dom-manipulation" title="DOM manipulation" class="md-nav__link">
    DOM manipulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-recon" title="Domain recon" class="md-nav__link">
    Domain recon
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="castle.html" title="Castle" class="md-nav__link">
      Castle
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Objectives
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Objectives
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="Objectives/1-orientation.html" title="Orientation" class="md-nav__link">
      Orientation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Objectives/2-cfp.html" title="Directory Browsing" class="md-nav__link">
      Directory Browsing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Objectives/3-sequence.html" title="de Bruijn Sequences" class="md-nav__link">
      de Bruijn Sequences
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Objectives/4-datarepo.html" title="Data Repo Analysis" class="md-nav__link">
      Data Repo Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Objectives/5-adpriv.html" title="AD Privilege Discovery" class="md-nav__link">
      AD Privilege Discovery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Objectives/6-badge.html" title="Badge Manipulation" class="md-nav__link">
      Badge Manipulation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Objectives/7-hr.html" title="HR Incident Response" class="md-nav__link">
      HR Incident Response
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Objectives/8-packalyzer.html" title="Network Traffic Forensics" class="md-nav__link">
      Network Traffic Forensics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Objectives/9-ransomware.html" title="Ransomware Discovery" class="md-nav__link">
      Ransomware Discovery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Objectives/10-whodunit.html" title="Who is Behind it All?" class="md-nav__link">
      Who is Behind it All?
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Terminal Challenges
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Terminal Challenges
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="Terminals/1-namegame.html" title="The Name Game" class="md-nav__link">
      The Name Game
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Terminals/2-editorskills.html" title="Essential Editor Skills" class="md-nav__link">
      Essential Editor Skills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Terminals/3-curling.html" title="CURLing Master" class="md-nav__link">
      CURLing Master
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Terminals/4-stallmucking.html" title="Stall Mucking Report" class="md-nav__link">
      Stall Mucking Report
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Terminals/5-pythonescape.html" title="Python Escape from LA" class="md-nav__link">
      Python Escape from LA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Terminals/6-devopsfail.html" title="DevOps Fail" class="md-nav__link">
      DevOps Fail
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Terminals/7-thesleighbell.html" title="The Seighbell" class="md-nav__link">
      The Seighbell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Terminals/8-forensics.html" title="Lethal ForensicELFication" class="md-nav__link">
      Lethal ForensicELFication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Terminals/9-loganalysis.html" title="Yule Log Analysis" class="md-nav__link">
      Yule Log Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Terminals/10-ventilation.html" title="Ventilation Maze" class="md-nav__link">
      Ventilation Maze
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="narrative.html" title="Narrative" class="md-nav__link">
      Narrative
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="eggs.html" title="Easter Eggs" class="md-nav__link">
      Easter Eggs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="answers.html" title="Answers" class="md-nav__link">
      Answers
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#curiosity" title="Curiosity" class="md-nav__link">
    Curiosity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#websockets" title="WebSockets" class="md-nav__link">
    WebSockets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dna" title="DNA" class="md-nav__link">
    DNA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dom-manipulation" title="DOM manipulation" class="md-nav__link">
    DOM manipulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-recon" title="Domain recon" class="md-nav__link">
    Domain recon
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="linecon">LineCon</h1>
<p>Around October, invitations were sent out for the 2018 Holiday Hack Challenge.  According to the invitations, attendees were welcome to sign up and explore the virtual world that KringleCon would take place in.  </p>
<p>The pre-event period became known as LineCon - the sometimes lengthy queue of attendees outside of a convention waiting for the doors to open.  This provided some opportunities to kick the tires on the game envrionment and do a little recon work that could possibly help later.</p>
<blockquote>
<p>From: SANS Institute <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#115;&#97;&#110;&#115;&#64;&#115;&#97;&#110;&#115;&#46;&#111;&#114;&#103;">&#115;&#97;&#110;&#115;&#64;&#115;&#97;&#110;&#115;&#46;&#111;&#114;&#103;</a></p>
<p>Subject:  SANS Holiday Hack Challenge Sneak-Peak: Register Now for the Fun and Adventure</p>
<p>Greetings, Holiday Hackers!</p>
<p>It's time to return to the North Pole for a very special event: KringleCon 2018. This year the makers of the SANS Holiday Hack Challenge, NetWars, and SANS Pen Test training courses invite you to a place of wonder, destiny, and hacking magic!</p>
<p>Register now at www.kringlecon.com and create your avatar for KringleCon!</p>
<p>What is KringleCon? It is a virtual holiday hacking event that will be hosted by Santa and his team at the North Pole in mid-December 2018. Security-minded people and hackers from around the world will come together virtually to help improve the state of cybersecurity worldwide and protect the holidays from dastardly cyber attackers.</p>
<p>Registration is completely FREE, but space is limited for this very special event!</p>
<p>Why register now when it's not even December? Well now, that's kind of a surprise, and we wouldn't want to ruin it for you…</p>
<p>You can even poke around the KringleCon website and look for a little special magic in this sneak-peak preview.</p>
<p>Welcome back to the fun and adventure of the SANS Holiday Hack Challenge!!!</p>
<p>REGISTER NOW at www.kringlecon.com to secure your place!</p>
</blockquote>
<h2 id="curiosity">Curiosity</h2>
<p>If you signed up during LineCon, you might have noticed the the registration pages on the KringleCon website incremented in name: two, three, four.  I wondered what would happen if I browsed to the next couple pages in logical sequence, and was greeted with a message that said "You're curious.  We like that!"</p>
<h2 id="websockets">WebSockets</h2>
<p>Browsing to kringlecon.com through a web interception proxy, I quickly discovered that client-server communication takes place over WebSockets.  A few players took advantage of this open standard to develop bots that could chat with or follow other players around.  Besides watching the traffic go back and forth to learn more about what's happening under the hood, the OWASP ZAP proxy also gave me the ability to inject my own messages to either the server or the client.  This didn't amount to much aside from moving avatars around on the screen.</p>
<h2 id="dna">DNA</h2>
<p>Each avatar's appearance, the specific combination of head, eyes, mouth, torso, legs and coloration, is encoded in a string that resembles a DNA sequence.  The game client reads these sequences from the server so that it knows how to display each player's avatar.  Sending an invalid DNA string to the server results in your avatar being set to a random sequence of DNA.  Sending an invalid DNA string to the client results in your avatar being changed to MissingNo (see Easter Eggs).</p>
<h2 id="dom-manipulation">DOM manipulation</h2>
<p>Since so much of the game is run client-side, the world around us is open to manipulation.</p>
<p>Many selfies were posted to social media during LineCon, demonstrating what players were able to do.  Some very skillful players were able to rearrange massive numbers of avatars in various formations.  My skills pale in comparison, but I was able to alter the world enough to capture this shot from the other side of the gates:</p>
<p><img alt="Linecon Selfie" src="img/linecon-selfie.png" /></p>
<p>Using my browser's developer tools, I observed that the camera angle and object orientation in the virtual world are defined by CSS properties.  Each set of grid coordinates has a pre-defined set of values that tell the client how to position your avatar and camera view.  Once I figured out how to reference these elements, I was able to set my own style properties to override the game's pre-defined settings.</p>
<div class="codehilite"><pre><span></span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;camera&#39;</span><span class="p">).</span><span class="nx">item</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">transform</span><span class="o">=</span><span class="s1">&#39;rotateX(-3deg) rotateY(185deg) rotateZ(0deg) translate3d(-791.667px, 128px, -500px)&#39;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;me&#39;</span><span class="p">).</span><span class="nx">item</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">transform</span><span class="o">=</span><span class="s1">&#39;scale(-1,1) translate3d(-1000px, 0px, -800px)&#39;</span>
</pre></div>


<p>Another popular trick during LineCon was to make the gate disappear, but of course this was just a visual trick and didn't allow anyone to cross the threshold.</p>
<div class="codehilite"><pre><span></span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;gate-section center&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span><span class="o">=</span><span class="s1">&#39;hidden&#39;</span><span class="p">;</span>
</pre></div>


<h2 id="domain-recon">Domain recon</h2>
<p>While waiting around for KringleCon to begin, I also checked to see if any additional domains had been registered for this year's event.  Based on the WHOIS data for kringlecon.com, I performed a reverse WHOIS search, and discovered several domains were created in 2018 with the same Registrant name "Counter Hack".</p>
<table>
<thead>
<tr>
<th>Domain Name</th>
<th>Creation Date</th>
<th>Registrar</th>
</tr>
</thead>
<tbody>
<tr>
<td>kinglecon.com</td>
<td>2018-05-25</td>
<td>GODADDY.COM, LLC</td>
</tr>
<tr>
<td>erohetfanu.com</td>
<td>2018-10-16</td>
<td>GODADDY.COM, LLC</td>
</tr>
<tr>
<td>kringlecastle.com</td>
<td>2018-10-12</td>
<td>GODADDY.COM, LLC</td>
</tr>
</tbody>
</table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="index.html" title="Introduction" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Introduction
              </span>
            </div>
          </a>
        
        
          <a href="castle.html" title="Castle" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Castle
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.b41f3d20.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
    
    
      
    
  </body>
</html>